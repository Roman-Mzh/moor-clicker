(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const t of o.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&c(t)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}})();const C="/assets/byt-DuUB1dve.jpg",_="/assets/coin-DHADmtpw.jpg",h="/assets/drova-B1_3CkoW.jpg",y="/assets/drovosek-0Gu3FA4h.jpg",E="/assets/sand-NAU3yeRp.jpg",w="/assets/svai-C0htLECH.jpg",$="/assets/trtr-DE8-K9Tz.jpg",b={Card1:{name:"Трактор",initialPrice:100,initialCpm:5,pic:"trtr"},Card2:{name:"Песок",initialPrice:80,initialCpm:3,pic:"sand"},Card3:{name:"Дачнег",initialPrice:120,initialCpm:1,pic:"drovosek"},Card4:{name:"Сваи",initialPrice:320,initialCpm:14,pic:"svai"},Card5:{name:"Бытовка",initialPrice:100,initialCpm:1,pic:"byt"},Card6:{name:"Дрова",initialPrice:20,initialCpm:1,pic:"drova"}},v=(i,e)=>{const{initialCpm:a,initialPrice:c}=b[i],s=e>0?a*1.3**(e-1):0,o=e>0?a*1.3**e:a,t=e>0?c*1.8**e:c;return{totalCpm:s,nextPrice:t,nextCpm:o}},x=()=>{const i=document.querySelector("#balance"),e=document.querySelector("#coin"),a=document.querySelector("#income"),c=document.querySelector("#cards");if(!i||!e||!a||!c)throw new Error("oops");return{balance:i,cardsList:c,coin:e,income:a}},g=["Card1","Card2","Card3","Card4","Card5","Card6"],j=i=>{const{coin:e,balance:a,income:c}=x(),s=()=>{const{realCoinz:o,lastEvent:t}=i.getState();a.innerText=o.toFixed(2),c.innerText="+"+t.totalIncome.toFixed(2)+"/sec",g.forEach(n=>{const r=t.cards[n],{nextCpm:m,nextPrice:u}=v(n,r),d=t.income[n],p=u>Math.max(t.totalIncome,o);document.getElementById(`card-${n}-level`).innerText=String(r),document.getElementById(`card-${n}-income`).innerText="+"+d.toFixed(2)+"/sec";const l=document.querySelector(`#card-${n}-btn`);l.innerText=`+${m.toFixed(2)} $${u.toFixed(2)} (${(u/m).toFixed(2)})`,l.disabled=p,p?(l.classList.remove("btn-primary"),l.classList.add("btn-outline-secondary")):(l.classList.remove("btn-outline-secondary"),l.classList.add("btn-primary"))})};setInterval(s,1e3),g.forEach(o=>{const t=document.getElementById(`card-${o}-btn`);if(!t)throw new Error("oops, no card");t.addEventListener("click",()=>{i.upCard(o),s()})}),e.addEventListener("click",()=>{i.click(),s()}),e.addEventListener("mousedown",({offsetX:o,offsetY:t})=>{const n=Math.round((o-60)/2),r=Math.round((t-60)/2);console.log(n,r),e.style.transform=`rotateX(${-r}deg) rotateY(${n}deg)`,e.classList.remove("shadow")}),e.addEventListener("mouseup",()=>{e.style.transform="",e.classList.add("shadow")})},L=()=>{const i={coinz:0,timestamp:Date.now(),cards:Object.fromEntries(g.map(t=>[t,0])),income:Object.fromEntries(g.map(t=>[t,0])),totalIncome:0},e=[],a=()=>{e.push(i)},c=()=>{const t=e.at(-1);if(!t)throw new Error("could not start game");const n=Date.now(),r=t.coinz+(n-t.timestamp)/1e3*t.totalIncome;return{lastEvent:t,realCoinz:r}},s=()=>{const{lastEvent:t,realCoinz:n}=c(),r={...t,coinz:Math.max(n,t.coinz)+10,timestamp:Date.now()};return e.push(r),r},o=t=>{const{lastEvent:n,realCoinz:r}=c(),{nextPrice:m,nextCpm:u}=v(t,n.cards[t]);if(m>Math.max(r,n.coinz))throw new Error("not enough coinz");const d={...n,cards:{...n.cards,[t]:n.cards[t]+=1},coinz:Math.max(r,n.coinz)-m,timestamp:Date.now()};return d.income={...d.income,[t]:d.income[t]+u},d.totalIncome=g.reduce((p,l)=>p+=d.income[l],0),e.push(d),d};return a(),{getState:c,click:s,upCard:o}},z=i=>new URL(Object.assign({"/src/utils/pics/byt.jpg":C,"/src/utils/pics/coin.jpg":_,"/src/utils/pics/drova.jpg":h,"/src/utils/pics/drovosek.jpg":y,"/src/utils/pics/sand.jpg":E,"/src/utils/pics/svai.jpg":w,"/src/utils/pics/trtr.jpg":$})[`/src/utils/pics/${i}.jpg`],import.meta.url).href,P=()=>{const i=L(),{balance:e,cardsList:a,income:c}=x(),s=t=>{const{lastEvent:n,realCoinz:r}=i.getState(),m=n.cards[t],u=n.income[t],d=b[t],{nextCpm:p,nextPrice:l}=v(t,m),f=l>Math.max(n.totalIncome,r);return`<div class="col-6">
      <div class="border rounded-2 p-2 d-flex flex-column gap-4">
        <div class="d-flex justify-content-between align-items-start w-100">
          <div class="h4">${d.name}</div>
          <div class="badge text-bg-light" id="card-${t}-level">${m}</div>
        </div>
        <img class="img-fluid" src="${z(d.pic)}" style="max-height: 140px; object-fit: cover;" />
        <div class="d-flex justify-content-center">
          <div class="h6 text-success" id="card-${t}-income">+${u.toFixed(2)}/sec</div>
        </div>
        <button id="card-${t}-btn" class="btn btn-outline-${f?"secondary":"primary"}" ${f?'disabled="disabled"':""}>+${p.toFixed(2)} $${l.toFixed(2)}</button>
      </div>
    </div>`};(()=>{const{realCoinz:t,lastEvent:n}=i.getState();e.innerText=t.toFixed(2),c.innerText="+"+n.totalIncome.toFixed(2)+"/sec",a.innerHTML=g.map(s).join("")})(),j(i)};P();

(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const t of c.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&i(t)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();const C="/moor-clicker/assets/byt-DuUB1dve.jpg",_="/moor-clicker/assets/coin-DHADmtpw.jpg",h="/moor-clicker/assets/drova-B1_3CkoW.jpg",y="/moor-clicker/assets/drovosek-0Gu3FA4h.jpg",E="/moor-clicker/assets/sand-NAU3yeRp.jpg",w="/moor-clicker/assets/svai-C0htLECH.jpg",j="/moor-clicker/assets/trtr-DE8-K9Tz.jpg",b={Card1:{name:"Трактор",initialPrice:100,initialCpm:5,pic:"trtr"},Card2:{name:"Песок",initialPrice:80,initialCpm:3,pic:"sand"},Card3:{name:"Дачнег",initialPrice:120,initialCpm:1,pic:"drovosek"},Card4:{name:"Сваи",initialPrice:320,initialCpm:14,pic:"svai"},Card5:{name:"Бытовка",initialPrice:100,initialCpm:1,pic:"byt"},Card6:{name:"Дрова",initialPrice:20,initialCpm:1,pic:"drova"}},v=(s,e)=>{const{initialCpm:a,initialPrice:i}=b[s],n=e>0?a*1.3**(e-1):0,c=e>0?a*1.3**e:a,t=e>0?i*1.8**e:i;return{totalCpm:n,nextPrice:t,nextCpm:c}},x=()=>{const s=document.querySelector("#balance"),e=document.querySelector("#coin"),a=document.querySelector("#income"),i=document.querySelector("#cards");if(!s||!e||!a||!i)throw new Error("oops");return{balance:s,cardsList:i,coin:e,income:a}},g=["Card1","Card2","Card3","Card4","Card5","Card6"],$=s=>{const{coin:e,balance:a,income:i}=x(),n=()=>{const{realCoinz:c,lastEvent:t}=s.getState();a.innerText=c.toFixed(2),i.innerText="+"+t.totalIncome.toFixed(2)+"/sec",g.forEach(o=>{const r=t.cards[o],{nextCpm:m,nextPrice:u}=v(o,r),d=t.income[o],p=u>Math.max(t.totalIncome,c);document.getElementById(`card-${o}-level`).innerText=String(r),document.getElementById(`card-${o}-income`).innerText="+"+d.toFixed(2)+"/sec";const l=document.querySelector(`#card-${o}-btn`);l.innerText=`${m.toFixed(2)} $${u.toFixed(2)}`,l.disabled=p,p?(l.classList.remove("btn-primary"),l.classList.add("btn-outline-secondary")):(l.classList.remove("btn-outline-secondary"),l.classList.add("btn-primary"))})};setInterval(n,1e3),g.forEach(c=>{const t=document.getElementById(`card-${c}-btn`);if(!t)throw new Error("oops, no card");t.addEventListener("click",()=>{s.upCard(c),n()})}),e.addEventListener("click",()=>{s.click(),n()}),e.addEventListener("mousedown",({offsetX:c,offsetY:t})=>{const o=Math.round((c-60)/2),r=Math.round((t-60)/2);console.log(o,r),e.style.transform=`rotateX(${-r}deg) rotateY(${o}deg)`,e.classList.remove("shadow")}),e.addEventListener("mouseup",()=>{e.style.transform="",e.classList.add("shadow")})},L=()=>{const s={coinz:0,timestamp:Date.now(),cards:Object.fromEntries(g.map(t=>[t,0])),income:Object.fromEntries(g.map(t=>[t,0])),totalIncome:0},e=[],a=()=>{e.push(s)},i=()=>{const t=e.at(-1);if(!t)throw new Error("could not start game");const o=Date.now(),r=t.coinz+(o-t.timestamp)/1e3*t.totalIncome;return{lastEvent:t,realCoinz:r}},n=()=>{const{lastEvent:t,realCoinz:o}=i(),r={...t,coinz:Math.max(o,t.coinz)+10,timestamp:Date.now()};return e.push(r),r},c=t=>{const{lastEvent:o,realCoinz:r}=i(),{nextPrice:m,nextCpm:u}=v(t,o.cards[t]);if(m>Math.max(r,o.coinz))throw new Error("not enough coinz");const d={...o,cards:{...o.cards,[t]:o.cards[t]+=1},coinz:Math.max(r,o.coinz)-m,timestamp:Date.now()};return d.income={...d.income,[t]:d.income[t]+u},d.totalIncome=g.reduce((p,l)=>p+=d.income[l],0),e.push(d),d};return a(),{getState:i,click:n,upCard:c}},z=s=>new URL(Object.assign({"/src/utils/pics/byt.jpg":C,"/src/utils/pics/coin.jpg":_,"/src/utils/pics/drova.jpg":h,"/src/utils/pics/drovosek.jpg":y,"/src/utils/pics/sand.jpg":E,"/src/utils/pics/svai.jpg":w,"/src/utils/pics/trtr.jpg":j})[`/src/utils/pics/${s}.jpg`],import.meta.url).href,P=()=>{const s=L(),{balance:e,cardsList:a,income:i}=x(),n=t=>{const{lastEvent:o,realCoinz:r}=s.getState(),m=o.cards[t],u=o.income[t],d=b[t],{nextCpm:p,nextPrice:l}=v(t,m),f=l>Math.max(o.totalIncome,r);return`<div class="col-6">
      <div class="border rounded-2 p-2 d-flex flex-column gap-2">
        <div class="d-flex justify-content-between align-items-start w-100">
          <div class="h4">${d.name}</div>
          <div class="badge text-bg-light" id="card-${t}-level">${m}</div>
        </div>
        <img class="img-fluid" src="${z(d.pic)}" style="max-height: 140px; object-fit: cover;" />
        <div class="d-flex justify-content-center">
          <div class="h6 text-success" id="card-${t}-income">${u.toFixed(2)}/sec</div>
        </div>
        <button id="card-${t}-btn" class="btn btn-outline-${f?"secondary":"primary"}" ${f?'disabled="disabled"':""}>+${p.toFixed(2)} $${l.toFixed(2)}</button>
      </div>
    </div>`};(()=>{const{realCoinz:t,lastEvent:o}=s.getState();e.innerText=t.toFixed(2),i.innerText="+"+o.totalIncome.toFixed(2)+"/sec",a.innerHTML=g.map(n).join("")})(),$(s)};P();
